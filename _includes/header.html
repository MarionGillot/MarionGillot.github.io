<header>
  <div class="mobile-header" @scroll.window="atTop = ( window.scrollY > 100 ? false : true )">

    <div class="header__bar__mobile">
      <div class="left_header_mobile">
        <button class="header__menu-btn menu-btn" aria-label="menu" aria-expanded="false" aria-controls="mainNav"
        @pointerdown="menuIsOpen = !menuIsOpen" :class="menuIsOpen && 'menu-btn--open'">
        Menu
        </button>
      </div>
      <div class="right_header_mobile">
        <div class="language-switch">
          <a href="#" class="lang-link" data-lang="french">FR</a> /
          <a href="#" class="lang-link" data-lang="english">EN</a>
        </div>
        <button onclick="toggleDarkMode()">
          <img class="header__logo__mode" id="mode-toggle" src="assets/public/icon/icon_moon.svg" alt="logo du mode dark">
        </button>
      </div>

      <nav class="header__menu menu" id="mainNav" :class="menuIsOpen && 'menu--open'">
        <ul class="menu__list list-unstyled">
          <li class="menu__item"><a class="menu__link" href="index.html">Projets</a></li>
          <li class="menu__item"><a class="menu__link" href="apropos.html">À propos</a></li>
        </ul>
      </nav>
    </div>
  </div>

  <div class="desktop-header" :class="{ 'header--atTop' : !atTop }">
    <div class="left_header">
      <p id="header-menu-label">Menu</p>
      <ul class="header_menu">
        <li class="header_menu_item"><a class="header_menu_link" href="index.html">Accueil ↗</a></li>
        <li class="header_menu_item"><a class="header_menu_link" href="projects.html">Réalisations ↗</a></li>
        <li class="header_menu_item"><a class="header_menu_link" href="apropos.html">À propos ↗</a></li>
      </ul>
    </div>
    <div class="center_header">
      <div class="language-switch">
        <a href="#" class="lang-link" data-lang="french">FR</a> /
        <a href="#" class="lang-link" data-lang="english">EN</a>
      </div>

      <button onclick="toggleDarkMode()" class="mode-toggle-button">
        <img class="header__logo__mode" id="mode-toggle-desktop" src="assets/public/icon/icon_moon.svg"
          alt="logo du mode dark">
      </button>
    </div>
    <div class="right_header">
      <p id="header_email"><a href="mailto:mgillot.pro@gmail.com">mgillot.pro@gmail.com</a></p>
    </div>
  </header>

<script type="module">
  // Récupération langue de la page
  const pageLanguage = location.pathname.includes('-en') ? 'english' : 'french';

  function highlightActiveLanguage() {
    document.querySelectorAll('.lang-link').forEach(link => {
      if (link.dataset.lang === pageLanguage) {
        link.classList.add('active');
      } else {
        link.classList.remove('active');
      }
    });
  }

  document.querySelectorAll('.lang-link').forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      let targetLang = link.dataset.lang;
      let file = location.pathname.split('/').pop() || 'index.html';

      // Retrait de -en si présent
      file = file.replace('-en', '');

      // Ajout de -en si page en anglais
      if (targetLang === 'english') {
        file = file.replace('.html', '-en.html');
      }

      location.href = file;
    });
  });

  function updateHeaderLinksAndLabels() {
    const links = document.querySelectorAll('.header_menu_link, .header a');

    links.forEach(link => {
      let href = link.getAttribute('href') || '';
      href = href.replace('-en', '');

      if (pageLanguage === 'english') {
        href = href.replace('.html', '-en.html');
      }
      link.setAttribute('href', href);

      const destination = href.replace('-en', '').split('/').pop() || '';
      if (destination.startsWith('index')) {
        link.textContent = pageLanguage === 'english' ? 'Home ↗' : 'Accueil ↗';
      } else if (destination.startsWith('projects')) {
        link.textContent = pageLanguage === 'english' ? 'Projects ↗' : 'Réalisations ↗';
      } else if (destination.startsWith('apropos')) {
        link.textContent = pageLanguage === 'english' ? 'About me ↗' : 'À propos ↗';
      }
    });
  }

  highlightActiveLanguage();
  updateHeaderLinksAndLabels();
</script>